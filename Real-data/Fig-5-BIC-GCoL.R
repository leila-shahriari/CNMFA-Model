rm(list = ls())

library(ggplot2)
library(gridExtra)


mydata = scan()
385418 377310 368502 359042 352460 348492 341345 336164 336343 333427 335374 340020 343206 350574 353366
382657 373837 352734 350242 344976 343502 339075 337547 332082 330534 340231 342545 348660 350818 352013
370844 360852 345437 343877 340618 337740 332583 328704 326340 323152 327044 330448 339466 342884 348415
377466 371544 366804 360411 354625 349994 344906 341208 338131 335040 341919 345706 349947 353041 358512
391580 386576 377044 371887 366549 359094 355460 352129 346506 340815 345656 352083 359663 364888 369644
404719 400527 393292 383336 378130 373230 367131 363131 356901 353155 359567 369178 378059 380995 400350

cormat_CN_EM <- matrix(mydata, ncol = 15, nrow = 6,byrow=T)

mydata = scan()
383894 376131 366322 355489 351153 346272 339665 334815 333788 330991 333864 338372 340813 349396 350688
380130 369611 350409 346819 343802 341154 337723 335162 330733 328278 337785 340290 346193 348589 351783
365674 358432 343040 340458 339268 335548 331148 326404 322893 320664 324699 328977 335999 340994 345839
376987 370100 363499 358974 353082 347649 342607 338730 335757 333632 339759 344451 346670 350756 356392
389274 385136 375746 368675 365227 356766 352991 349735 343970 337579 343085 350736 356215 362396 367414
402418 398715 391074 381007 376021 371002 364070 358897 353939 350876 356189 367759 375789 379018 388295

cormat_CN_AECM <- matrix(mydata, ncol = 15, nrow = 6,byrow=T)

######################################################################-

size <-rep(1:15, times = 6) 

rate <- rep(c("g=2", "g=3", "g=4","g=5", "g=6", "g=7"), each = 15)

#####################################################################-

df11.cn = c(cormat_CN_EM[1,], cormat_CN_EM[2,], 
            cormat_CN_EM[3,], cormat_CN_EM[4,],
            cormat_CN_EM[5,], cormat_CN_EM[6,])

df1.cn <- data.frame(year = size, type = rate, value = df11.cn)

p1.cn = ggplot(data = df1.cn, 
               mapping = aes(x = size, y = log(df11.cn), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("EM algorithm -- CNMFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", 
        text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", "8", 
                                 "9", "10", "11",
                                 "12", "13", "14", "15", "16"))

######################################################################-

df33.cn = c(cormat_CN_AECM[1,], cormat_CN_AECM[2,],
            cormat_CN_AECM[3,], cormat_CN_AECM[4,],
            cormat_CN_AECM[5,], cormat_CN_AECM[6,])

df3.cn <- data.frame(year = size, type = rate, value = df33.cn)

p3.cn =ggplot(data = df3.cn, 
              mapping = aes(x = size, y = log(df33.cn), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("AECM-algorithm -- CNMFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", 
        text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", 
                                 "8", "9", "10", 
                                 "11","12", "13", 
                                 "14", "15", "16"))

######################################################################
######################################################################

mydata = scan()
392844 383121 378164 367984 361074 358697 355943 353865 346964 343135 347695 353085 356561 359321 361017
390642 380917 360836 357214 353302 352443 348484 346663 342805 340088 342495 345976 353992 355728 357557
383787 376738 354849 352862 350674 349030 346371 344347 340129 338341 341478 344571 348092 350560 353015
390020 383098 372586 365360 360577 355209 352962 349766 346386 342963 347890 350758 355673 359544 362158
402322 390140 383355 375251 370535 364599 360801 357087 351029 352941 353347 359216 365536 370977 375472
412928 410544 400234 390712 385682 380984 373862 369343 362913 363785 367926 375588 383273 390016 400356

cormat_N_EM <- matrix(mydata, ncol = 15, nrow = 6,byrow=T)

mydata = scan()
391850 381100 370003 361523 358530 357109 354108 351563 344967 341886 345998 351999 354753 357862 359776
389365 379996 358987 355552 352632 350756 346958 344553 341459 338789 340698 343998 351659 355361 355754
381100 376350 352787 350932 349373 348635 344774 342925 339556 336769 340398 342891 346609 348394 351995
390421 383269 371245 363756 358339 353458 351420 347906 345591 340440 346320 348556 353996 357749 361256
400970 389986 382236 373998 369256 363105 358623 353165 350698 343552 351420 357550 363930 368862 377659
411998 410236 399423 389999 383998 378663 372368 368236 363550 358753 365990 374236 382469 389559 399990

cormat_N_AECM <- matrix(mydata, ncol = 15, nrow = 6, byrow=T)

######################################################################-

df11.n = c(cormat_N_EM[1,], cormat_N_EM[2,],
           cormat_N_EM[3,], cormat_N_EM[4,],
           cormat_N_EM[5,],cormat_N_EM[6,])

df1.n <- data.frame(year = size, type = rate, value = df11.n)

p1.n = ggplot(data = df1.n, 
              mapping = aes(x = size, y = log(df11.n), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("EM-algorithm -- MFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", 
        text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", 
                                 "8", "9", "10", 
                                 "11","12", "13", 
                                 "14", "15", "16"))

######################################################################-

df33.n = c(cormat_N_AECM[1,], cormat_N_AECM[2,], 
         cormat_N_AECM[3,], cormat_N_AECM[4,],
         cormat_N_AECM[5,],cormat_N_AECM[6,])

df3.n <- data.frame(year = size, type = rate, value = df33.n)

p3.n = ggplot(data = df3.n, 
              mapping = aes(x = size, y = log(df33.n), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("AECM-algorithm -- MFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", 
        text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", 
                                 "8", "9", "10", 
                                 "11","12", "13", 
                                 "14", "15", "16"))

######################################################################
######################################################################

mydata=scan()
386618 379630 370467 361094 354266 350992 343690 340475 338212 335693 337493 342560 345597 353470 355323
384939 375247 354998 350477 347427 345736 341313 338776 335539 332043 342540 344001 350925 352230 355486
372345 363153 348710 345255 343858 339134 334885 330003 328552 325443 329321 333686 341671 344618 350658
379751 373819 368127 362704 356883 351332 346266 343401 340403 337313 343367 347137 351313 355536 360949
393917 388819 379444 373390 368855 361507 357700 354315 348769 342205 347914 354440 361954 366177 371212
406211 402349 395746 385651 380577 375523 369629 365529 355573 358544 361893 371491 380349 382823 392981

cormat_t_EM <- matrix(mydata, ncol = 15, nrow = 6,byrow=T)

mydata=scan()
385741 378279 368542 358329 352366 349070 342465 338290 336021 334046 335479 341111 343752 350357 354439
383074 372279 353065 347592 345544 342820 339384 336867 332629 330115 333670 342049 347961 350261 353533
370444 360240 345761 342370 340935 337170 332930 329077 325615 323468 326446 330735 338702 342689 348753
378888 371852 365193 360738 354929 348435 343330 340475 338430 335353 340404 345230 348447 352653 358987
390964 385868 376527 370435 365942 358596 355811 351453 340847 345249 346018 352491 359007 363301 368236
404262 400434 393824 382683 378650 372572 365721 361592 352623 355665 358909 369529 378458 380924 391113

cormat_t_AECM <- matrix(mydata, ncol = 15, nrow = 6,byrow=T)

################################################################-

df11.t = c(cormat_t_EM[1,], cormat_t_EM[2,],
         cormat_t_EM[3,], cormat_t_EM[4,],
         cormat_t_EM[5,],cormat_t_EM[6,])

df1.t <- data.frame(year = size, type = rate, value = df11.t)

p1.t = ggplot(data = df1.t, 
              mapping = aes(x = size, y = log(df11.t), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("EM-algorithm -- TMFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", 
        text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", 
                                 "8", "9", "10", 
                                 "11","12", "13", 
                                 "14", "15", "16"))

######################################################################-

df33.t = c(cormat_t_AECM[1,], cormat_t_AECM[2,], 
           cormat_t_AECM[3,], cormat_t_AECM[4,], 
           cormat_t_AECM[5,], cormat_t_AECM[6,])

df3.t <- data.frame(year = size, type = rate, value = df33.t)

p3.t = ggplot(data = df3.t, 
              mapping = aes(x = size, y = log(df33.t), colour = rate)) + 
  geom_line() +
  geom_point() +
  ggtitle("AECM-algorithm -- TMFA") +
  xlab("q") + ylab("log(BIC)") +  
  theme(legend.position = "", text = element_text(size = 10)) + 
  labs(colour = "Group")  +
  scale_x_continuous(breaks=1:15,
                     labels = c( "2", "3", "4", 
                                 "5", "6","7", 
                                 "8", "9", "10", 
                                 "11","12", "13", 
                                 "14", "15", "16"))
library(patchwork)

Function.PATH = "/Users/gthb3/Dropbox/PhD students/Shahriari/My code"

postscript(paste(Function.PATH, '/F1.eps', sep=''), width=27, height=27)
(p1.n + p1.cn + p1.t) / (p3.n + p3.cn + p3.t) / guide_area() +
  plot_layout (guides = "collect", heights
                    = c(3, 3, 1)) &
  theme(legend.position = "bottom", legend.title = element_blank())
dev.off()



